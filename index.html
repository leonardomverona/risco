<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>VISA Digital - Licenciamento Sanitário</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <!-- Roboto Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap">
  <!-- FontAwesome para ícones -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Select2 CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css">
  <style>
    :root {
      --primary-color: #003087;
      --secondary-color: #00AEEF;
      --accent-color: #001F5B;
      --background-color: #f0f2f5;
      --card-bg: #ffffff;
      --text-color: #222;
      --transition-speed: 0.3s;
    }
    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background-color: var(--background-color);
      color: var(--text-color);
    }
    /* Cabeçalho */
    header {
      background-color: var(--primary-color);
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }
    .navbar-brand {
      display: flex;
      align-items: center;
      color: #fff;
      text-decoration: none;
    }
    /* Ajuste do logo e textos no cabeçalho */
    .navbar-brand .logo-container {
      display: flex;
      align-items: center;
    }
    .navbar-brand .logo-svg {
      /* Ajuste do tamanho do ícone da cruz com seta */
      width: 40px;
      height: 40px;
      margin-right: 10px;
      flex-shrink: 0;
    }
    .navbar-brand .logo-text {
      line-height: 1;
    }
    .navbar-brand .logo-text .main-title {
      font-size: 1.3rem;
      font-weight: 700;
      text-transform: uppercase;
    }
    .navbar-brand .logo-text .subtitle {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .navbar-nav .nav-link {
      color: #fff;
      font-size: 1.1rem;
      padding: 0.75rem 1rem;
    }
    .navbar-nav .nav-link:hover {
      color: var(--secondary-color);
    }
    .progress-container {
      height: 8px;
      background: #ddd;
    }
    .progress-bar {
      height: 100%;
      width: 0;
      background: var(--secondary-color);
      transition: width var(--transition-speed) ease-in-out;
    }
    /* Seção Hero com degradê e imagem central */
    .hero {
      position: relative;
      height: 70vh;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 0 20px;
      color: #fff;
    }
    .hero img {
      max-width: 200px;
      margin-bottom: 20px;
    }
    .hero h1 {
      font-size: 3.5rem;
      font-weight: 700;
      margin-bottom: 20px;
    }
    .hero p {
      font-size: 1.5rem;
      margin-bottom: 30px;
    }
    .hero .btn {
      font-size: 1.1rem;
      padding: 10px 20px;
    }
    /* Seção de Conteúdo */
    .content-section {
      padding: 60px 20px;
    }
    .content-section h2 {
      color: var(--primary-color);
      font-weight: 700;
      margin-bottom: 20px;
    }
    .content-section p {
      font-size: 1.1rem;
      margin-bottom: 20px;
    }
    /* Cartões e Formulários */
    .form-section {
      background: var(--card-bg);
      padding: 40px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      margin-bottom: 40px;
    }
    .form-section label {
      font-weight: 500;
    }
    .cnae-card {
      background: #f8f9fa;
      border: 1px solid #ced4da;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
    }
    footer {
      background-color: var(--accent-color);
      color: #fff;
      text-align: center;
      padding: 20px 10px;
    }
    @media (max-width: 576px) {
      .hero h1 { font-size: 2.5rem; }
      .hero p { font-size: 1.2rem; }
      .navbar-brand .logo-text .main-title {
        font-size: 1.1rem;
      }
      .navbar-brand .logo-text .subtitle {
        font-size: 0.6rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <nav class="navbar navbar-expand-lg container">
      <a class="navbar-brand" href="#inicio">
        <div class="logo-container">
        <svg id="Camada_1" data-name="Camada 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 452.04 122.67" fit="" height="100%" width="100%" preserveAspectRatio="xMidYMid meet" focusable="false">
          <defs>
            <style>
              .cls-1 {
                fill: #fff;
              }
            </style>
          </defs>
          <g>
            <path class="cls-1" d="m149.5,61.75l-5.69,15.14h-2.87l-5.71-15.14h2.65l4.49,12.59,4.51-12.59s2.62,0,2.62,0Z"></path>
            <path class="cls-1" d="m155.36,61.75v15.14h-2.49v-15.14s2.49,0,2.49,0Z"></path>
            <path class="cls-1" d="m170.89,66.11c-.4-.75-.94-1.32-1.64-1.7-.7-.38-1.5-.58-2.42-.58-1,0-1.89.22-2.67.67-.78.45-1.4,1.09-1.84,1.92-.43.83-.67,1.79-.67,2.87s.22,2.05.67,2.89c.45.83,1.05,1.47,1.84,1.94.78.45,1.67.67,2.67.67,1.35,0,2.45-.38,3.29-1.14s1.35-1.79,1.55-3.07h-5.69v-1.99h8.35v1.94c-.17,1.19-.58,2.25-1.25,3.24s-1.55,1.77-2.64,2.37c-1.09.58-2.29.88-3.61.88-1.42,0-2.72-.33-3.91-.99-1.17-.67-2.1-1.59-2.81-2.76-.68-1.19-1.04-2.5-1.04-3.99s.35-2.81,1.04-3.99c.68-1.19,1.62-2.09,2.81-2.76,1.19-.67,2.49-.99,3.89-.99,1.62,0,3.06.4,4.31,1.19s2.17,1.92,2.74,3.37h-2.99.02Z"></path>
            <path class="cls-1" d="m180.57,61.75v15.14h-2.49v-15.14s2.49,0,2.49,0Z"></path>
            <path class="cls-1" d="m187.64,74.89h5.13v2h-7.6v-15.14h2.49v13.14h-.02Z"></path>
            <path class="cls-1" d="m205.25,73.81h-6.34l-1.09,3.09h-2.59l5.43-15.16h2.87l5.43,15.16h-2.62l-1.09-3.09h0Zm-3.16-14.79l-3.12,1.87v-1.94l3.12-1.8,3.12,1.8v1.94l-3.12-1.87Zm2.45,12.77l-2.45-7.05-2.49,7.05h4.94Z"></path>
            <path class="cls-1" d="m225.07,76.9h-2.49l-7.48-11.3v11.3h-2.49v-15.16h2.49l7.48,11.29v-11.29h2.49v15.16h0Z"></path>
            <path class="cls-1" d="m229.85,65.31c.68-1.19,1.62-2.09,2.81-2.76s2.49-.99,3.89-.99c1.62,0,3.06.4,4.31,1.19s2.17,1.92,2.74,3.37h-2.99c-.4-.8-.94-1.39-1.64-1.79-.7-.38-1.5-.58-2.42-.58-1,0-1.89.22-2.67.67s-1.4,1.1-1.84,1.94-.67,1.82-.67,2.94.22,2.1.67,2.94,1.05,1.49,1.84,1.95c.78.45,1.67.68,2.67.68.92,0,1.72-.2,2.42-.58.7-.38,1.24-.99,1.64-1.79h2.99c-.57,1.45-1.49,2.57-2.74,3.36s-2.69,1.17-4.31,1.17c-1.42,0-2.72-.33-3.91-.99-1.17-.67-2.1-1.59-2.81-2.76-.68-1.19-1.04-2.5-1.04-3.99s.35-2.81,1.04-3.99h.02Z"></path>
            <path class="cls-1" d="m250.27,61.75v15.14h-2.49v-15.14s2.49,0,2.49,0Z"></path>
            <path class="cls-1" d="m263.97,73.81h-6.34l-1.09,3.09h-2.59l5.43-15.16h2.87l5.43,15.16h-2.62l-1.09-3.09h0Zm-.7-2.02l-2.45-7.05-2.49,7.05h4.94Z"></path>
            <path class="cls-1" d="m280.55,76.51c-.82-.35-1.45-.87-1.92-1.52s-.7-1.42-.7-2.29h2.65c.07.65.32,1.19.77,1.62.45.42,1.1.63,1.92.63s1.52-.2,2-.62.72-.95.72-1.6c0-.5-.15-.92-.45-1.24s-.67-.57-1.12-.73-1.05-.37-1.84-.57c-.99-.27-1.79-.53-2.4-.8-.62-.27-1.15-.68-1.59-1.25s-.65-1.32-.65-2.27c0-.87.22-1.64.65-2.29s1.05-1.15,1.84-1.5,1.69-.52,2.72-.52c1.47,0,2.67.37,3.61,1.1s1.45,1.74,1.55,3.02h-2.74c-.05-.55-.3-1.02-.78-1.42-.48-.38-1.12-.58-1.9-.58-.72,0-1.29.18-1.74.55-.45.37-.67.88-.67,1.57,0,.47.13.85.42,1.14.28.3.65.53,1.09.7s1.04.37,1.79.57c1,.28,1.82.55,2.45.83s1.17.7,1.62,1.27.67,1.34.67,2.3c0,.77-.2,1.5-.62,2.19s-1.02,1.24-1.8,1.65-1.72.62-2.81.62c-1.02,0-1.94-.18-2.74-.53v-.03Z"></path>
            <path class="cls-1" d="m301.91,73.81h-6.34l-1.09,3.09h-2.59l5.43-15.16h2.87l5.43,15.16h-2.62l-1.09-3.09h0Zm-.7-2.02l-2.45-7.05-2.49,7.05h4.94Z"></path>
            <path class="cls-1" d="m321.73,76.9h-2.49l-7.48-11.3v11.3h-2.49v-15.16h2.49l7.48,11.29v-11.29h2.49v15.16h0Z"></path>
            <path class="cls-1" d="m328.78,61.75v15.14h-2.49v-15.14s2.49,0,2.49,0Z"></path>
            <path class="cls-1" d="m343.14,61.75v2.02h-4.02v13.12h-2.49v-13.12h-4.06v-2.02s10.57,0,10.57,0Z"></path>
            <path class="cls-1" d="m356.08,73.81h-6.34l-1.09,3.09h-2.59l5.43-15.16h2.87l5.43,15.16h-2.62l-1.09-3.09h0Zm-.92-15.29l-4.81,2.37v-1.84l4.81-2.65v2.12Zm.22,13.27l-2.45-7.05-2.49,7.05h4.94Z"></path>
            <path class="cls-1" d="m371.32,76.9l-3.49-6.06h-1.89v6.06h-2.49v-15.14h5.23c1.17,0,2.15.2,2.96.62.8.4,1.4.95,1.8,1.64s.6,1.45.6,2.29c0,.99-.28,1.89-.87,2.69-.57.8-1.45,1.35-2.65,1.64l3.76,6.28h-2.97.02Zm-5.38-8.05h2.74c.94,0,1.64-.23,2.1-.7s.7-1.09.7-1.87-.23-1.4-.7-1.84c-.47-.45-1.17-.67-2.12-.67h-2.74v5.08h.02Z"></path>
            <path class="cls-1" d="m381,61.75v15.14h-2.49v-15.14s2.49,0,2.49,0Z"></path>
            <path class="cls-1" d="m394.71,73.81h-6.34l-1.09,3.09h-2.59l5.43-15.16h2.87l5.43,15.16h-2.62l-1.09-3.09h0Zm-.7-2.02l-2.45-7.05-2.49,7.05h4.94Z"></path>
            <path class="cls-1" d="m418.24,62.69c1.22.62,2.15,1.5,2.81,2.65.67,1.15.99,2.5.99,4.04s-.33,2.87-.99,4.01c-.67,1.14-1.6,2-2.81,2.6-1.22.6-2.62.9-4.24.9h-4.94v-15.14h4.94c1.62,0,3.02.3,4.24.92v.02Zm-.17,10.75c.95-.95,1.42-2.3,1.42-4.06s-.47-3.14-1.42-4.12c-.95-.99-2.3-1.49-4.07-1.49h-2.45v11.09h2.45c1.77,0,3.12-.48,4.07-1.44v.02Z"></path>
            <path class="cls-1" d="m428.83,76.06c-1.19-.67-2.12-1.59-2.81-2.77-.68-1.19-1.04-2.52-1.04-3.99s.35-2.81,1.04-3.99c.68-1.19,1.62-2.09,2.81-2.76,1.19-.67,2.49-.99,3.89-.99s2.72.33,3.91.99c1.19.67,2.12,1.59,2.81,2.76.68,1.17,1.02,2.5,1.02,3.99s-.33,2.82-1.02,3.99c-.68,1.19-1.62,2.1-2.81,2.77-1.19.67-2.49.99-3.91.99s-2.7-.33-3.89-.99Zm6.56-1.85c.78-.45,1.4-1.12,1.84-1.95s.67-1.84.67-2.96-.22-2.1-.67-2.94-1.05-1.49-1.84-1.94-1.67-.67-2.69-.67-1.89.22-2.67.67-1.4,1.1-1.84,1.94-.67,1.82-.67,2.94.22,2.1.67,2.96c.45.85,1.05,1.5,1.84,1.95s1.67.68,2.67.68,1.9-.23,2.69-.68Z"></path>
            <path class="cls-1" d="m139.32,89.33v4.51h5.31v2.05h-5.31v4.72h5.97v2.05h-8.5v-15.4h8.5v2.05h-5.97v.02Z"></path>
            <path class="cls-1" d="m152.01,102.29c-.83-.36-1.48-.88-1.95-1.54s-.71-1.44-.71-2.32h2.7c.07.66.32,1.2.78,1.65.46.42,1.12.64,1.95.64s1.54-.2,2.04-.63.73-.97.73-1.63c0-.51-.15-.93-.46-1.26s-.68-.58-1.14-.75-1.07-.37-1.87-.58c-1-.27-1.82-.54-2.44-.81-.63-.27-1.17-.7-1.61-1.27s-.66-1.34-.66-2.31c0-.88.22-1.66.66-2.32s1.07-1.17,1.87-1.53,1.71-.53,2.76-.53c1.49,0,2.71.37,3.66,1.12s1.48,1.76,1.58,3.07h-2.78c-.05-.56-.31-1.03-.8-1.44-.49-.39-1.14-.59-1.93-.59-.73,0-1.31.19-1.76.56-.46.37-.68.9-.68,1.59,0,.47.14.87.42,1.15.29.31.66.54,1.1.71s1.05.37,1.82.58c1.02.29,1.85.56,2.49.85s1.19.71,1.65,1.29.68,1.36.68,2.34c0,.78-.2,1.53-.63,2.22s-1.03,1.26-1.83,1.68-1.75.63-2.85.63c-1.03,0-1.97-.19-2.78-.54v-.03Z"></path>
            <path class="cls-1" d="m174.37,87.29v2.05h-4.09v13.33h-2.53v-13.33h-4.12v-2.05s10.74,0,10.74,0Z"></path>
            <path class="cls-1" d="m187.51,99.54h-6.45l-1.1,3.14h-2.63l5.51-15.4h2.92l5.51,15.4h-2.66l-1.1-3.14h0Zm-.71-2.05l-2.49-7.16-2.53,7.16h5.02Z"></path>
            <path class="cls-1" d="m204.32,88.24c1.24.63,2.19,1.53,2.85,2.7.68,1.17,1,2.54,1,4.11s-.34,2.92-1,4.07c-.68,1.15-1.63,2.04-2.85,2.65-1.24.61-2.66.92-4.31.92h-5.02v-15.39h5.02c1.65,0,3.07.31,4.31.93v.02Zm-.17,10.92c.97-.97,1.44-2.34,1.44-4.12s-.47-3.19-1.44-4.19c-.97-1-2.34-1.51-4.14-1.51h-2.49v11.26h2.49c1.8,0,3.17-.49,4.14-1.46v.02Z"></path>
            <path class="cls-1" d="m215.08,101.83c-1.2-.68-2.15-1.61-2.85-2.82-.7-1.2-1.05-2.56-1.05-4.05s.36-2.85,1.05-4.05,1.65-2.12,2.85-2.8,2.53-1,3.95-1,2.76.34,3.97,1c1.2.68,2.15,1.61,2.85,2.8.7,1.19,1.03,2.54,1.03,4.05s-.34,2.87-1.03,4.05c-.7,1.2-1.65,2.14-2.85,2.82-1.2.68-2.53,1-3.97,1s-2.75-.34-3.95-1Zm6.67-1.88c.8-.46,1.42-1.14,1.87-1.98s.68-1.87.68-3-.22-2.14-.68-2.99-1.07-1.51-1.87-1.97-1.7-.68-2.73-.68-1.92.22-2.71.68-1.42,1.12-1.87,1.97-.68,1.85-.68,2.99.22,2.14.68,3c.46.87,1.07,1.53,1.87,1.98s1.7.7,2.71.7,1.93-.24,2.73-.7Z"></path>
            <path class="cls-1" d="m247.12,88.24c1.24.63,2.19,1.53,2.85,2.7.68,1.17,1,2.54,1,4.11s-.34,2.92-1,4.07c-.68,1.15-1.63,2.04-2.85,2.65-1.24.61-2.66.92-4.31.92h-5.02v-15.39h5.02c1.65,0,3.07.31,4.31.93v.02Zm-.17,10.92c.97-.97,1.44-2.34,1.44-4.12s-.47-3.19-1.44-4.19c-.97-1-2.34-1.51-4.14-1.51h-2.49v11.26h2.49c1.8,0,3.17-.49,4.14-1.46v.02Z"></path>
            <path class="cls-1" d="m257.33,89.33v4.51h5.31v2.05h-5.31v4.72h5.97v2.05h-8.5v-15.4h8.5v2.05h-5.97v.02Z"></path>
            <path class="cls-1" d="m291.02,87.29v15.39h-2.53v-10.53l-4.7,10.53h-1.75l-4.72-10.53v10.53h-2.53v-15.39h2.73l5.39,12.06,5.38-12.06h2.71Z"></path>
            <path class="cls-1" d="m298.2,87.29v15.39h-2.53v-15.39s2.53,0,2.53,0Z"></path>
            <path class="cls-1" d="m315.48,102.68h-2.53l-7.6-11.48v11.48h-2.53v-15.4h2.53l7.6,11.47v-11.47h2.53v15.4h0Z"></path>
            <path class="cls-1" d="m329.41,99.54h-6.45l-1.1,3.14h-2.63l5.51-15.4h2.92l5.51,15.4h-2.66l-1.1-3.14Zm-.71-2.05l-2.49-7.16-2.53,7.16h5.02,0Z"></path>
            <path class="cls-1" d="m339.16,102.29c-.83-.36-1.48-.88-1.95-1.54s-.71-1.44-.71-2.32h2.7c.07.66.32,1.2.78,1.65.46.42,1.12.64,1.95.64s1.54-.2,2.04-.63.73-.97.73-1.63c0-.51-.15-.93-.46-1.26s-.68-.58-1.14-.75-1.07-.37-1.87-.58c-1-.27-1.82-.54-2.44-.81-.63-.27-1.17-.7-1.61-1.27s-.66-1.34-.66-2.31c0-.88.22-1.66.66-2.32s1.07-1.17,1.87-1.53,1.71-.53,2.76-.53c1.49,0,2.71.37,3.66,1.12s1.48,1.76,1.58,3.07h-2.78c-.05-.56-.31-1.03-.8-1.44-.49-.39-1.14-.59-1.93-.59-.73,0-1.31.19-1.76.56-.46.37-.68.9-.68,1.59,0,.47.14.87.42,1.15.29.31.66.54,1.1.71s1.05.37,1.82.58c1.02.29,1.85.56,2.49.85.64.29,1.19.71,1.65,1.29s.68,1.36.68,2.34c0,.78-.2,1.53-.63,2.22s-1.03,1.26-1.83,1.68c-.8.42-1.75.63-2.85.63-1.03,0-1.97-.19-2.78-.54v-.03Z"></path>
            <path class="cls-1" d="m369.81,91.72c-.41-.76-.95-1.34-1.66-1.73-.71-.39-1.53-.59-2.46-.59-1.02,0-1.92.22-2.71.68-.8.46-1.42,1.1-1.87,1.95-.44.85-.68,1.82-.68,2.92s.22,2.09.68,2.93,1.07,1.49,1.87,1.97c.8.46,1.7.68,2.71.68,1.37,0,2.49-.39,3.34-1.15s1.37-1.82,1.58-3.12h-5.78v-2.02h8.48v1.97c-.17,1.2-.59,2.29-1.27,3.29s-1.58,1.8-2.68,2.41c-1.1.59-2.32.9-3.66.9-1.44,0-2.76-.34-3.97-1-1.19-.68-2.14-1.61-2.85-2.8-.7-1.2-1.05-2.54-1.05-4.05s.36-2.85,1.05-4.05,1.65-2.12,2.85-2.8,2.53-1,3.95-1c1.65,0,3.1.41,4.38,1.2s2.21,1.95,2.78,3.43h-3.04.02Z"></path>
            <path class="cls-1" d="m379.64,89.33v4.51h5.31v2.05h-5.31v4.72h5.97v2.05h-8.5v-15.4h8.5v2.05h-5.97v.02Z"></path>
            <path class="cls-1" d="m398.02,102.68l-3.55-6.16h-1.92v6.16h-2.53v-15.39h5.31c1.19,0,2.19.2,3,.63.81.41,1.42.97,1.83,1.66s.61,1.48.61,2.32c0,1-.29,1.92-.88,2.73-.58.81-1.48,1.37-2.7,1.66l3.82,6.38h-3.02.02Zm-5.46-8.18h2.78c.95,0,1.66-.24,2.14-.71s.71-1.1.71-1.9-.24-1.42-.71-1.87c-.48-.46-1.19-.68-2.15-.68h-2.78v5.16h.02Z"></path>
            <path class="cls-1" d="m414.63,99.54h-6.45l-1.1,3.14h-2.63l5.51-15.4h2.92l5.51,15.4h-2.66l-1.1-3.14h0Zm-.71-2.05l-2.49-7.16-2.53,7.16h5.02,0Z"></path>
            <path class="cls-1" d="m424.64,87.29v15.39h-2.53v-15.39s2.53,0,2.53,0Z"></path>
            <path class="cls-1" d="m431.56,102.29c-.83-.36-1.48-.88-1.95-1.54s-.71-1.44-.71-2.32h2.7c.07.66.32,1.2.78,1.65.46.42,1.12.64,1.95.64s1.54-.2,2.04-.63.73-.97.73-1.63c0-.51-.15-.93-.46-1.26s-.68-.58-1.14-.75-1.07-.37-1.87-.58c-1-.27-1.82-.54-2.44-.81-.63-.27-1.17-.7-1.61-1.27s-.66-1.34-.66-2.31c0-.88.22-1.66.66-2.32s1.07-1.17,1.87-1.53,1.71-.53,2.76-.53c1.49,0,2.71.37,3.66,1.12s1.48,1.76,1.58,3.07h-2.78c-.05-.56-.31-1.03-.8-1.44-.49-.39-1.14-.59-1.93-.59-.73,0-1.31.19-1.76.56-.46.37-.68.9-.68,1.59,0,.47.14.87.42,1.15.29.31.66.54,1.1.71s1.05.37,1.82.58c1.02.29,1.85.56,2.49.85.64.29,1.19.71,1.65,1.29s.68,1.36.68,2.34c0,.78-.2,1.53-.63,2.22s-1.03,1.26-1.83,1.68c-.8.42-1.75.63-2.85.63-1.03,0-1.97-.19-2.78-.54v-.03Z"></path>
          </g>
          <g>
            <path class="cls-1" d="m164.48,12.83l-12.45,35.1h-10.7l-12.45-35.1h9.1l8.7,26.5,8.75-26.5h9.05,0Z"></path>
            <path class="cls-1" d="m176.58,12.83v35.1h-8.55V12.83h8.55Z"></path>
            <path class="cls-1" d="m188.58,47.03c-2.03-.83-3.66-2.06-4.88-3.7-1.21-1.64-1.86-3.6-1.92-5.9h9.1c.13,1.3.58,2.29,1.35,2.98.76.68,1.76,1.02,3,1.02s2.26-.29,3-.87c.73-.58,1.1-1.39,1.1-2.42,0-.87-.29-1.58-.87-2.15-.58-.56-1.3-1.03-2.15-1.4-.85-.37-2.06-.79-3.63-1.25-2.27-.7-4.11-1.4-5.55-2.1s-2.67-1.73-3.7-3.1c-1.03-1.37-1.55-3.15-1.55-5.35,0-3.26,1.18-5.82,3.55-7.68,2.37-1.85,5.45-2.78,9.25-2.78s6.98.93,9.35,2.78,3.64,4.42,3.8,7.73h-9.25c-.06-1.14-.48-2.02-1.25-2.68s-1.75-.98-2.95-.98c-1.03,0-1.87.28-2.5.83s-.95,1.34-.95,2.37c0,1.14.53,2.02,1.6,2.65,1.06.64,2.73,1.32,5,2.05,2.26.77,4.11,1.5,5.53,2.2,1.41.7,2.64,1.72,3.68,3.05,1.03,1.33,1.55,3.05,1.55,5.15s-.51,3.82-1.52,5.45c-1.02,1.64-2.49,2.93-4.42,3.9s-4.22,1.45-6.85,1.45-4.87-.41-6.9-1.25v-.02Z"></path>
            <path class="cls-1" d="m235.37,41.73h-13.1l-2.1,6.2h-8.95l12.7-35.1h9.9l12.7,35.1h-9.05l-2.1-6.2h0Zm-2.2-6.6l-4.35-12.85-4.3,12.85h8.65Z"></path>
            <path class="cls-1" d="m273.22,15.03c2.76,1.47,4.91,3.53,6.42,6.18s2.28,5.71,2.28,9.17-.76,6.48-2.28,9.15-3.67,4.73-6.45,6.2c-2.78,1.47-6.01,2.2-9.67,2.2h-13.15V12.83h13.15c3.7,0,6.93.73,9.7,2.2h0Zm-2.7,22.85c1.8-1.76,2.7-4.26,2.7-7.5s-.9-5.75-2.7-7.55c-1.8-1.8-4.32-2.7-7.55-2.7h-4.05v20.4h4.05c3.23,0,5.75-.88,7.55-2.65Z"></path>
            <path class="cls-1" d="m295.26,12.83v35.1h-8.55V12.83h8.55Z"></path>
            <path class="cls-1" d="m324.77,23.93c-.64-1.17-1.54-2.06-2.72-2.68-1.18-.62-2.57-.93-4.18-.93-2.76,0-4.99.91-6.65,2.72-1.67,1.82-2.5,4.24-2.5,7.27,0,3.23.87,5.76,2.63,7.57,1.75,1.82,4.16,2.72,7.23,2.72,2.1,0,3.87-.53,5.33-1.6,1.45-1.06,2.51-2.6,3.18-4.6h-10.85v-6.3h18.6v7.95c-.64,2.14-1.71,4.11-3.22,5.95s-3.44,3.32-5.77,4.45c-2.33,1.14-4.97,1.7-7.9,1.7-3.47,0-6.56-.75-9.27-2.27-2.72-1.52-4.84-3.63-6.35-6.33s-2.27-5.78-2.27-9.25.75-6.56,2.27-9.27c1.52-2.72,3.63-4.84,6.33-6.35,2.7-1.52,5.78-2.28,9.25-2.28,4.2,0,7.74,1.02,10.62,3.05s4.79,4.85,5.72,8.45h-9.45l-.02.02Z"></path>
            <path class="cls-1" d="m348.11,12.83v35.1h-8.55V12.83h8.55Z"></path>
            <path class="cls-1" d="m379.55,12.83v6.85h-9.3v28.25h-8.55v-28.25h-9.3v-6.85h27.15,0Z"></path>
            <path class="cls-1" d="m405.71,41.73h-13.1l-2.1,6.2h-8.95l12.7-35.1h9.9l12.7,35.1h-9.05l-2.1-6.2h0Zm-2.2-6.6l-4.35-12.85-4.3,12.85h8.65Z"></path>
            <path class="cls-1" d="m429.25,41.33h11.2v6.6h-19.75V12.83h8.55v28.5Z"></path>
          </g>
          <path class="cls-1" d="m51.38,11.07h21.74c5.73,0,10.42,4.69,10.42,10.42v18.98h18.98c5.73,0,10.42,4.69,10.42,10.42v15.74c-3.05-.99-6.1-1.97-9.15-2.95v-12.78c0-.7-.57-1.27-1.27-1.27h-28.13v-28.14c0-.7-.57-1.27-1.27-1.27h-21.74c-.7,0-1.27.58-1.27,1.27v28.14h-28.13c-.7,0-1.27.57-1.27,1.27v21.74c0,.7.57,1.29,1.27,1.29,9.38,0,18.76-.02,28.13-.02v23.87c9.05-7.96,18.09-15.91,27.14-23.87h16.33c.98,3.05,1.96,6.09,2.95,9.13h-15.82l-32.02,28.16c-2.87,2.74-7.74.75-7.74-3.31v-24.86l-18.98.02c-5.73,0-10.42-4.69-10.42-10.42v-21.74c0-5.73,4.69-10.42,10.42-10.42h18.98v-18.98c0-5.73,4.69-10.42,10.42-10.42h0Zm70.51,66.6c1.97-.81,2.32-3.57-.04-4.45-8.12-2.62-15.9-5.16-24.06-7.77-1.66-.53-2.99.8-2.46,2.46,2.61,8.16,5.15,15.94,7.77,24.06.88,2.36,3.65,2,4.46.04,3.46-8.42,5.91-10.88,14.33-14.34h0Z"></path>
        </svg>
        </div>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link" href="#inicio">Início</a></li>
          <li class="nav-item"><a class="nav-link" href="#sobre">Sobre</a></li>
          <li class="nav-item"><a class="nav-link" href="#servico">Serviço</a></li>
          <li class="nav-item"><a class="nav-link" href="#contato">Contato</a></li>
        </ul>
      </div>
    </nav>
    <div class="progress-container">
      <div id="progressBar" class="progress-bar"></div>
    </div>
  </header>

  <section class="hero" id="inicio">
    <div class="hero-content">
      <img src="https://visadigital.saude.mg.gov.br/assets/images/tela-inicial.png" alt="VISA Digital">
      <h1>Licenciamento Sanitário</h1>
      <p>Classificação de Risco e Fiscalização em Minas Gerais</p>
      <a href="#servico" class="btn btn-lg btn-outline-light">Iniciar</a>
    </div>
  </section>

  <main class="container content-section">
    <section id="sobre">
      <h2>Onde requerer seu licenciamento?</h2>
      <p>
        O VISA Digital centraliza o acesso ao Licenciamento Sanitário em Minas Gerais. Nosso sistema avalia o risco do seu estabelecimento e orienta sobre a competência da fiscalização e os procedimentos para obtenção do alvará.
      </p>
    </section>

    <section id="servico" class="mt-5">
      <!-- Etapa 1: Formulário -->
      <div id="step1" class="form-section">
        <form id="riskForm" novalidate>
          <script>
            function updateProgress(percent) {
              document.getElementById("progressBar").style.width = percent + "%";
            }
            updateProgress(20);
          </script>
          <div class="row g-3 mb-4">
            <div class="col-md-6">
              <label class="form-label">Tipo de Cadastro:</label>
              <div class="btn-group w-100" role="group">
                <input type="radio" class="btn-check" name="tipoCadastro" id="cadPF" value="PF" checked onchange="atualizarDocLabel()">
                <label class="btn btn-outline-primary" for="cadPF">Pessoa Física</label>
                <input type="radio" class="btn-check" name="tipoCadastro" id="cadPJ" value="PJ" onchange="atualizarDocLabel()">
                <label class="btn btn-outline-primary" for="cadPJ">Pessoa Jurídica</label>
              </div>
            </div>
            <div class="col-md-6">
              <label class="form-label">Tipo de Concessão:</label>
              <div class="btn-group w-100" role="group">
                <input type="radio" class="btn-check" name="tipoConcessao" id="concessaoInicial" value="Inicial" checked>
                <label class="btn btn-outline-primary" for="concessaoInicial">Concessão Inicial</label>
                <input type="radio" class="btn-check" name="tipoConcessao" id="concessaoRenovacao" value="Renovacao">
                <label class="btn btn-outline-primary" for="concessaoRenovacao">Renovação</label>
              </div>
            </div>
          </div>
          <div class="row g-3 mb-4">
            <div class="col-md-4">
              <label id="docLabel" class="form-label">CPF:</label>
              <input type="text" id="doc" class="form-control" placeholder="000.000.000-00" required>
            </div>
            <div class="col-md-4">
              <label class="form-label">Razão Social:</label>
              <input type="text" id="razao" class="form-control" required>
            </div>
            <div class="col-md-4">
              <label class="form-label">Nome Fantasia:</label>
              <input type="text" id="nome_fantasia" class="form-control" required>
            </div>
          </div>
          <div class="mb-4">
            <h5>Atividades Econômicas (CNAEs)</h5>
            <p>Selecione as atividades econômicas para o alvará.</p>
            <div id="cnaesContainer"></div>
            <button type="button" class="btn btn-secondary" onclick="adicionarCNAE()">
              <i class="fas fa-plus me-2"></i>Adicionar CNAE
            </button>
          </div>
          <div class="row g-3 mb-4">
            <div class="col-md-6">
              <label class="form-label">Município:</label>
              <select id="municipio" class="form-select" required></select>
            </div>
          </div>
          <div class="d-flex justify-content-end">
            <button type="button" class="btn btn-primary" onclick="calcularRisco(); updateProgress(100); nextStep(2);">
              Enviar <i class="fas fa-arrow-right ms-2"></i>
            </button>
          </div>
        </form>
      </div>
      <!-- Etapa 2: Resultado -->
      <div id="step2" class="form-section" style="display:none;">
        <div class="result">
          <h3 class="mb-4">Resultado da Análise</h3>
          <div class="alert alert-success">
            <p><strong>Razão Social:</strong> <span id="resRazao"></span></p>
            <p><strong>Nome Fantasia:</strong> <span id="resNomeFantasia"></span></p>
            <p><strong>CNPJ/CPF:</strong> <span id="resDoc"></span></p>
            <p><strong>CNAEs:</strong> <span id="resCNAEs"></span></p>
            <p><strong>Nível de Risco:</strong> <span id="resRisco"></span></p>
            <p><strong>Orientações:</strong> <span id="resOrientacoes"></span></p>
          </div>
          <div class="text-center mt-4">
            <button class="btn btn-outline-primary me-2" onclick="voltarPasso(1)">
              <i class="fas fa-edit me-2"></i>Editar Dados
            </button>
            <button class="btn btn-success" onclick="reiniciarFluxo()">
              <i class="fas fa-redo me-2"></i>Novo Processo
            </button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer id="contato">
    <div class="container">
      <p>&copy; 2025 VISA Digital. Todos os direitos reservados.</p>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script type="module">
    let cnaesData = [];
    let cnaesIBGE = [];
    let jucemgMunicipios = [];
    let municipiosPact = {};
    const cnaesSelecionados = new Set();

    // URLs dos dados diretamente do GitHub
    const CNAE_JSON_URL = "https://raw.githubusercontent.com/leonardomverona/risco/refs/heads/main/cnae.json";
    const JUCEG_JSON_URL = "https://raw.githubusercontent.com/leonardomverona/risco/refs/heads/main/jucemgMunicipios.json";
    const PACT_CSV_URL = "https://raw.githubusercontent.com/leonardomverona/risco/refs/heads/main/municipiopact.csv";

    window.atualizarDocLabel = function() {
      const tipo = $('input[name="tipoCadastro"]:checked').val();
      const docInput = $('#doc');
      if (tipo === 'PJ') {
        $('#docLabel').text('CNPJ:');
        docInput.unmask().mask('00.000.000/0000-00');
        docInput.attr('placeholder', '00.000.000/0000-00');
      } else {
        $('#docLabel').text('CPF:');
        docInput.unmask().mask('000.000.000-00');
        docInput.attr('placeholder', '000.000.000-00');
      }
    };

    function formatarDescricao(str) {
      const exceptions = ["de", "da", "do", "das", "dos", "e", "para", "com", "a", "as", "em", "o", "os", "por"];
      return str.toLowerCase().split(' ').map((word, index) => {
        if (index === 0) return word.charAt(0).toUpperCase() + word.slice(1);
        return exceptions.includes(word) ? word : word.charAt(0).toUpperCase() + word.slice(1);
      }).join(' ');
    }

    function loadCSVAsync(url) {
      return new Promise((resolve, reject) => {
        Papa.parse(url, {
          download: true,
          header: true,
          skipEmptyLines: true,
          complete: (results) => results.errors.length ? reject(results.errors) : resolve(results.data),
          error: reject
        });
      });
    }

    async function loadCollections() {
      try {
        // Carrega CNAEs
        const cnaeResponse = await fetch(CNAE_JSON_URL);
        cnaesData = await cnaeResponse.json();
        cnaesData = cnaesData.map(cnae => ({
          ...cnae,
          visa: (cnae.Perguntas?.length > 0) || cnae.RiscoFixo !== "",
          code: cnae.CNAE,
          description: cnae["Descrição"],
          riskFixed: cnae.RiscoFixo,
          Perguntas: cnae.Perguntas
        }));

        // Carrega municípios do JUCEG
        const jucemgResponse = await fetch(JUCEG_JSON_URL);
        const jucemgData = await jucemgResponse.json();
        jucemgMunicipios = jucemgData.cidades;

        // Carrega dados do PACT via CSV
        const pactData = await loadCSVAsync(PACT_CSV_URL);
        pactData.forEach(row => municipiosPact[row.nome] = row.pact);

        await loadIBGECNAes();
        popularMunicipios();
      } catch (err) {
        console.error('Erro ao carregar dados:', err);
        alert('Erro ao carregar dados. Verifique o console.');
      }
    }

    async function loadIBGECNAes() {
      try {
        const ibgeResponse = await fetch('https://servicodados.ibge.gov.br/api/v2/cnae/subclasses');
        const dataApi = await ibgeResponse.json();
        cnaesIBGE = dataApi.map(item => ({
          code: item.id.replace(/\D/g, '').replace(/(\d{4})(\d{1})(\d{2})/, "$1-$2/$3"),
          description: formatarDescricao(item.descricao),
          Perguntas: [],
          riskFixed: "",
          visa: false
        }));

        const combined = [...cnaesData, ...cnaesIBGE];
        const seen = new Set();
        window.combinedCnaes = combined.filter(cnae => {
          const key = cnae.code.toUpperCase();
          if (seen.has(key)) return false;
          seen.add(key);
          return true;
        }).sort((a, b) => a.description.localeCompare(b.description));
      } catch (err) {
        console.error('Erro ao carregar CNAEs do IBGE:', err);
      }
    }

    function popularMunicipios() {
      const select = $('#municipio');
      select.empty().append('<option value="">-- Selecione --</option>');
      Object.keys(municipiosPact).sort().forEach(mun => {
        select.append(new Option(mun, mun));
      });
      select.select2({ width: '100%' });
    }

    $(document).ready(() => atualizarDocLabel());
    loadCollections();

    let cnaeCount = 0;
    window.adicionarCNAE = function() {
      if (!window.combinedCnaes) {
        alert("Dados de CNAE ainda não carregados.");
        return;
      }
      cnaeCount++;
      const novoCNAE = `
        <div class="cnae-card" data-uniqueid="${cnaeCount}">
          <div class="row g-3 align-items-center">
            <div class="col-md-9">
              <select class="form-select cnae-select" data-uniqueid="${cnaeCount}" onchange="verificarCNAE(this)">
                <option value=""></option>
                ${window.combinedCnaes.map(cnae => `
                  <option value="${cnae.code}" ${cnaesSelecionados.has(cnae.code) ? 'disabled' : ''}>
                    ${cnae.code} - ${cnae.description}
                  </option>
                `).join('')}
              </select>
            </div>
            <div class="col-md-3">
              <button type="button" class="btn btn-danger w-100" onclick="removerCNAE(this)">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </div>
          <div class="questions-container" style="display:none; margin-top:10px;"></div>
        </div>
      `;
      $('#cnaesContainer').append(novoCNAE);
      $('.cnae-select:last').select2({ placeholder: 'Selecione um CNAE', width: '100%' });
    };

    window.removerCNAE = function(botao) {
      const card = $(botao).closest('.cnae-card');
      const codigo = card.find('select').val();
      cnaesSelecionados.delete(codigo);
      $('.cnae-select option[value="'+codigo+'"]').prop('disabled', false);
      card.remove();
    };

    window.verificarCNAE = function(selectElem) {
      const uniqueId = $(selectElem).data('uniqueid');
      const codigoSelecionado = $(selectElem).val();
      if (!codigoSelecionado) return;

      cnaesSelecionados.add(codigoSelecionado);
      $('.cnae-select').not(selectElem).each(function() {
        $(this).find(`option[value="${codigoSelecionado}"]`).prop('disabled', true);
      });

      const cnae = window.combinedCnaes.find(item => item.code === codigoSelecionado);
      const card = $(selectElem).closest('.cnae-card');
      const questionsContainer = card.find('.questions-container');

      if (!cnae?.Perguntas?.length) {
        questionsContainer.hide().empty();
        return;
      }

      let html = '';
      cnae.Perguntas.forEach((q, i) => {
        const display = i === 0 ? 'block' : 'none';
        let onchangeAttr = '';
        if (i === 0 && cnae.Perguntas.length > 1) {
          onchangeAttr = ` onchange="verificarRespostaEncadeada(this, '${uniqueId}', ${i})"`;
        }
        html += `
          <div class="question-block" id="question_${uniqueId}_${i}" style="display:${display}; margin-bottom:10px;">
            <p class="mb-1 fw-bold">${q.text}</p>
            ${q.options.map(opt => `
              <label class="form-check-label me-3">
                <input type="radio" name="q_${uniqueId}_${i}" value="${opt.value}" ${onchangeAttr}>
                ${opt.value}
              </label>
            `).join('')}
          </div>
        `;
      });
      questionsContainer.html(html).show();
    };

    window.verificarRespostaEncadeada = function(radioElem, uniqueId, questionIndex) {
      if (questionIndex === 0 && $(radioElem).val() === 'NÃO') {
        $(`#question_${uniqueId}_1`).fadeIn(300);
      } else {
        $(`#question_${uniqueId}_1`).fadeOut(300).find('input').prop('checked', false);
      }
    };

    window.calcularRisco = function() {
      const doc = $('#doc').val().trim();
      const razao = $('#razao').val().trim();
      const nomeFantasia = $('#nome_fantasia').val().trim();
      const municipio = $('#municipio').val();
      if (!doc || !razao || !nome_fantasia || !municipio) {
        alert('Preencha todos os campos obrigatórios.');
        return;
      }
      if ($('.cnae-card').length === 0) {
        alert('Adicione ao menos um CNAE.');
        return;
      }
      let overallRisk = 0;
      let cnaesListHTML = "<ul class='list-unstyled'>";
      const allCnaes = window.combinedCnaes || [];
      $('.cnae-card').each(function() {
        const card = $(this);
        const uniqueId = card.data('uniqueid');
        const codigo = card.find('.cnae-select').val();
        const cnae = allCnaes.find(item => item.code === codigo);
        if (!cnae) return;
        cnaesListHTML += `<li>${cnae.code} - ${cnae.description}</li>`;
        if (cnae.visa) {
          let riscoCNAE = cnae.riskFixed ? parseInt(cnae.riskFixed) : 1;
          if (cnae.Perguntas?.length > 0) {
            cnae.Perguntas.forEach((pergunta, index) => {
              const resposta = card.find(`input[name="q_${uniqueId}_${index}"]:checked`).val();
              const opcao = pergunta.options.find(opt => opt.value === resposta);
              if (opcao?.risk !== undefined) {
                riscoCNAE = Math.max(riscoCNAE, opcao.risk);
              }
            });
          }
          overallRisk = Math.max(overallRisk, riscoCNAE);
        }
      });
      cnaesListHTML += "</ul>";

      let orientacoes = "";
      if (overallRisk === 0) {
        orientacoes = "Atividade não sujeita ao controle sanitário.";
      } else {
        const munFormulario = municipio.trim().toLowerCase();
        const encontrado = jucemgMunicipios.some(m => m.trim().toLowerCase() === munFormulario);
        switch(overallRisk) {
          case 1:
            orientacoes = "Atividade sujeita à fiscalização sem necessidade de alvará.";
            break;
          case 2:
            orientacoes = encontrado 
              ? `<a href="https://portalservicos.jucemg.mg.gov.br/" target="_blank">Acesse o REDESIM</a> para autorização.` 
              : `Procure a Vigilância Sanitária de ${municipio}.`;
            break;
          case 3:
            orientacoes = municipiosPact[municipio] === 'C' 
              ? `Procure a Vigilância Sanitária de ${municipio} para projeto e inspeção.` 
              : `<a href="https://visadigital.saude.mg.gov.br/" target="_blank">Acesse o VISA Digital</a> para licenciamento.`;
            break;
        }
      }
      const riscoDescricao = overallRisk === 0 ? "Não sujeito" 
                              : overallRisk === 1 ? "Nível I" 
                              : overallRisk === 2 ? "Nível II" 
                              : "Nível III";
      $("#resRazao").text(razao);
      $("#resNomeFantasia").text(nomeFantasia);
      $("#resDoc").text(doc);
      $("#resCNAEs").html(cnaesListHTML);
      $("#resRisco").text(riscoDescricao);
      $("#resOrientacoes").html(orientacoes);
    };

    window.reiniciarFluxo = () => location.reload();
    window.nextStep = function(stepNumber) {
      $('.form-section').fadeOut(300, () => {
        if (stepNumber === 1) {
          $('#step1').fadeIn(300);
        } else {
          $('#step2').fadeIn(300);
        }
        updateProgress(stepNumber === 1 ? 20 : 100);
      });
    };
    window.voltarPasso = stepNumber => nextStep(stepNumber);
  </script>
</body>
</html>
